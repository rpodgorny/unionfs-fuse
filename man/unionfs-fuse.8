.de Vb \" Begin verbatim text
.ft CW
.nf
.ne \\$1
..
.de Ve \" End verbatim text
.ft R
.fi
..
.TH "unionfs-fuse" "8" "June 2008" "unionfs-fuse 0.21" ""
.SH "NAME"
unionfs\-fuse \- A userspace unionfs implementation
.SH "SYNOPSIS"
.B unionfs\-fuse
\fB[\-o \fIoption1\fP \-o \fIoption2\fP ... \-o \fIoptionN\fP ]\fR
             \fBtop_branch:lower_branch:...:lowest_branch \fR
             \fBmount_point\fR
.SH "DESCRIPTION"
\fBunionfs\-fuse\fR overlays several directory into one single mount point.
.PP 
It first tries to access the file on the top branch and if the file does not exist
there, it continues on lower level branches.
If the user tries to modify a file on a lower level read\-only branch
the file is copied to to a higher level read\-write branch if the 
\fBcopy\-on\-write (cow) \fR mode was enabled.
.SH "OPTIONS"
Below is a summary of unionfs\-fuse options
.TP 
\fB\-o cow
Enable copy\-on\-write
.TP 
\fB\-o stats
Show statistics in the file 'stats' under the mountpoint.
.TP
\fB\-o correct_statfs
By default only blocks of rw-branches are counted in statfs() calls 
(e.g. by 'df'). On setting this option all branches will be counted for the 
summarry of blocks, but still only rw-branches count for available blocks.
While this is the most correct (TM) counting method, it will break all
tools calculating the usage percentage of mounted partitions.
.SH "Options to libfuse"
There are several further options available, which don't directly apply to
unionfs, but to libuse. Please run "unionfs-fuse --help" to see these.
We already set the "-o default-permissions" options on our own.
.SH "EXAMPLES"
.Vb 5
\& unionfs\-fuse \-o cow \-o allow_other \e
\&              \-o use_ino \-o nonempty \e
\&              /u/host/etc=RW:/u/group/etc=RO:/u/common/etc=RO \e
\&              /u/union/etc
.Ve
.SH "Meta data"
Like other filesystems unionfs-fuse also needs to store meta data. 
Well, presently only information about deleted files and directories need
to be stored, but in future releases more information might be required, e.g.
inode-numbers for persistent inode information.
Meta data information are saved and looked for in the .unionfs/
directories of each branch-root. So in the example above, these are
/u/host/etc/.unionfs, /u/group/etc/.unionfs and /u/common/etc/.unionfs.
Within these directories a complete directory structure may be found.
Example: If the admin decides to delete the file /etc/test/testfile, which
only exists in /u/unionfs/etc/test/testfile, unionfs-fuse can't delete this 
file, since it is on a read-only branch. So instead the whiteout file 
/u/host/etc/.unionfs/test/testfile_HIDDEN~ will be created. So on accessing
the union filesystem, test/testfile will not be visible.
Please also note that whiteout files/directories will only hide the files 
in lower level branches. So for example whiteouts in the group directory 
(/u/group/etc/.unionfs of the example above) will only hide file of the 
common branch (/u/common/etc), but not these of the group and host branches.
Especially for diskless-booted environments it is rather useful for the admin
to create whiteout files him/her-self. For example one should blacklist
network re-initializations, /etc/mtab, /etc/nologin of the server and several 
cron-scripts. This can be easily achieved by creating whiteout files for
these scripts in the group meta directory.
.SH "KNOWN ISSUES"
.Vb 5
\&1) Presently it is not possible to create a union for /\. This is work in progress. 
\&2) Another issue is that presently there is no support for read-only branches
when copy-on-write is disabled, thus, -ocow is NOT specified! Support for 
that might be added in later releases.
.VE
.SH "AUTHORS"
.B unionfs\-fuse
Original implemention by Radek Podgorny <radek@podgorny.cz>
.SH "COPYRIGHT"
Radek Podgorny <radek\@podgorny.cz>, Bernd Schubert <bernd\-schubert\@gmx.de>
.SH "THANKS"
Many thanks to the author of the FUSE filesystem Miklos Szeredi.
